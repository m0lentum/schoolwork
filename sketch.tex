%! TEX program = xelatex

\documentclass{article}
\usepackage[a4paper, margin=3cm]{geometry}
\setlength{\parindent}{0pt}
\setlength{\parskip}{1em}
%\usepackage{fontspec}
%\setmainfont{Lato}

\usepackage{amsmath,amssymb,amsthm}
%\usepackage{verbatim}
%\usepackage{graphicx}
%\usepackage{pgfplots}
%\pgfplotsset{compat=1.16}

\title{}
\author{Mikael Myyr√§}
\date{}

\begin{document}

Finding the intersection time of a bullet $b$ starting at the enemy
position $P_e$ in \textit{some direction} at a constant speed $s_b$ and a ray starting
at the position of the player $P_p$ at the velocity of the player relative to
the enemy $\mathbf{v}_{rel} = \mathbf{v}_p - \mathbf{v}_e$, i.e. the
intersection time of this ray with the sphere containing all possible
projectile positions at time $t$:
\begin{align*}
  ts_b &= |P_p + t\mathbf{v}_{rel} - P_e| \\
       &= |\mathbf{d} + t\mathbf{v}_{rel}| \qquad (\mathbf{d} = P_p - P_e) \\
       &= \sqrt{(\mathbf{d} + t\mathbf{v}_{rel}) \cdot (\mathbf{d} + t\mathbf{v}_{rel})} \\
  t^2s_b^2 &= (\mathbf{d} + t\mathbf{v}_{rel}) \cdot (\mathbf{d} + t\mathbf{v}_{rel}) \\
           &= \mathbf{d} \cdot \mathbf{d} + 2(\mathbf{d} \cdot t\mathbf{v}_{rel}) + t\mathbf{v}_{rel} \cdot t\mathbf{v}_{rel} \\
           &= |\mathbf{d}|^2 + 2t(\mathbf{d} \cdot \mathbf{v}_{rel}) + t^2|\mathbf{v}_{rel}|^2 \\
  (s_b^2 - |\mathbf{v}_{rel}|^2)t^2 - 2(\mathbf{d} \cdot \mathbf{v}_{rel})t - |\mathbf{d}|^2 &= 0 \\
\end{align*}
 quadratic formula:
 \[
   t = \frac{2(\mathbf{d} \cdot \mathbf{v}_{rel}) \pm \sqrt{4(\mathbf{d} \cdot \mathbf{v}_{rel})^2
   + 4(s_b^2 - |\mathbf{v}_{rel}|^2) |\mathbf{d}|^2}}{2(s_b^2 - |\mathbf{v}_{rel}|^2)}
 \]
This can be simplified a tiny bit by cancelling the twos:
\[
   t = \frac{(\mathbf{d} \cdot \mathbf{v}_{rel}) \pm \sqrt{(\mathbf{d} \cdot \mathbf{v}_{rel})^2
   + (s_b^2 - |\mathbf{v}_{rel}|^2) |\mathbf{d}|^2}}{s_b^2 - |\mathbf{v}_{rel}|^2}
\]
Find the lowest positive solution for $t$ and you get the predicted point of contact as
$P_p + t\mathbf{v}_p$.

\end{document}
